<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
    crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <!-- jQuery primeiro -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" crossorigin="anonymous"></script>
<title>CriptoRace v3 - Inscrição de candidato</title>
<style>
  html,body{
    height:100%;
    margin:0;
    background:#000;
    overflow:hidden;
    font-family:"Courier New", Courier, monospace;
  }
  canvas#matrix{
    display:block;
    position:fixed;
    top:0;left:0;
    width:100vw;height:100vh;
    background:black;
      z-index: 0;
  }
  .credits{
    position:fixed;
    left:12px;bottom:12px;
    color:#0f0;opacity:0.55;
    font-size:12px;
  }
  .container-topo{
      position: relative;
      z-index: 10;
  }
  .porta-logo{
      width: 90%;
      height: 50%;
      overflow: hidden;
      margin: auto;
  }
  .porta-logo img{
      width: 100%;
      height: auto;
  }
  .porta-botoes button{
      margin-bottom: 50px;
  }
  form label{
      color:red;
  }
  h3{
      color: lawngreen;
  }
</style>
</head>
<body>

<canvas id="matrix"></canvas>
<div class="credits">CriptoRace V3 - Quase nenhum direito reservado!</div>

<div class="container container-topo">
    <div class="porta-logo">
        <img src="../static/logo1.png" />
    </div>
    <h3>Logoff de candidato</h3>

    <div id="mensagem2"></div>
    <div id="entraJogo">
        <button type="button" class="btn btn-outline-danger btn-lg btn-block" onclick="vaiParaAHome()">Voltar à home</button>
    </div>
</div>

<script>
(() => {
  const canvas = document.getElementById('matrix');
  const ctx = canvas.getContext('2d');

  // parâmetros fixos
  const speedMultiplier = 2.5;
  const densityMultiplier = 3.0;
  const globalAlpha = 0.8;
  let paused = false;

  const charset = (
    'アイウエオカキクケコサシスセソタチツテトナニヌネノ' +
    '持つか持たないかが問題だ' +
    'ABCDEFGHIJKLMNOPQRSTUVWXYZ' +
    'abcdefghijklmnopqrstuvwxyz' +
    'Nensagens secretas CriptoRace' +
    '0123456789#666' +
    '!@#$%^&*()_+-=[]{}|;:,.<>/?'
  );

  let columns = [];
  let columnHeights = [];
  let fontSize = 18;

  function resize(){
    const DPR = window.devicePixelRatio || 1;
    canvas.width = Math.floor(window.innerWidth * DPR);
    canvas.height = Math.floor(window.innerHeight * DPR);
    ctx.setTransform(DPR,0,0,DPR,0,0);
    setupColumns();
  }
  window.addEventListener('resize', resize);

  function setupColumns(){
    const vw = Math.max(window.innerWidth,320);
    fontSize = Math.max(12, Math.round(vw / 80));
    ctx.font = fontSize + 'px monospace';
    const cols = Math.floor(window.innerWidth / fontSize);
    const effectiveCols = Math.max(2, Math.floor(cols * densityMultiplier));
    columns = new Array(effectiveCols);
    columnHeights = new Array(effectiveCols);
    for(let i=0;i<effectiveCols;i++){
      columns[i] = i * fontSize;
      columnHeights[i] = Math.floor(Math.random() * canvas.height / fontSize);
    }
  }

  const randChar = () => charset.charAt(Math.floor(Math.random() * charset.length));
  const greenColor = b => {
    const r = Math.floor(20 * (1 - b));
    const g = Math.floor(180 + 75 * b);
    const bl = Math.floor(20 * (1 - b));
    return `rgb(${r},${g},${bl})`;
  };

  let lastTime = 0;
  function step(time){
    if(!lastTime) lastTime = time;
    const dt = (time - lastTime)/1000;
    lastTime = time;
    if(!paused){
      ctx.fillStyle = `rgba(0,0,0,${0.08 / Math.max(0.08, globalAlpha)})`;
      ctx.fillRect(0,0,canvas.width,canvas.height);
      for(let i=0;i<columns.length;i++){
        const x = columns[i];
        const yLines = columnHeights[i];
        const yPx = yLines * fontSize;

        ctx.fillStyle = greenColor(1.0);
        ctx.globalAlpha = Math.min(1,globalAlpha);
        ctx.fillText(randChar(), x+2, yPx);

        const trailLen = 4;
        for(let t=1;t<=trailLen;t++){
          const yy = yPx - t*fontSize;
          if(yy<0) break;
          const bright = Math.max(0.15,1 - (t/(trailLen+1)));
          ctx.fillStyle = greenColor(bright);
          ctx.globalAlpha = Math.max(0.06, globalAlpha*(0.35*bright));
          ctx.fillText(randChar(), x+2, yy);
        }

        const baseSpeed = 5;
        const variance = (Math.random()*2 -1)*0.5;
        const deltaLines = (baseSpeed + variance) * speedMultiplier * dt;
        columnHeights[i] = yLines + deltaLines;
        if(columnHeights[i]*fontSize > canvas.height + 50 + Math.random()*500)
          columnHeights[i] = Math.random()*-30;
      }
      ctx.globalAlpha = 1.0;
    }
    requestAnimationFrame(step);
  }

  resize();
  ctx.fillStyle = 'black';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  requestAnimationFrame(step);

  // pausa automática se guia ficar oculta
  document.addEventListener('visibilitychange', () => {
    paused = document.hidden;
  });
})();
</script>
<script>
    $(document).ready(function () {
        localStorage.removeItem('candidato'); // limpa storage
        $("#mensagem2").html('<div class="alert alert-success">Logoff realizado com sucesso!</div>');
    });
    function vaiParaOJogo(){
        window.location.href = "{{ url_for('frontend.competir') }}";
    }
    function vaiParaAHome(){
        window.location.href = "{{ url_for('frontend.index') }}";
    }
    function vaiVerORanking(){
        window.location.href = "{{ url_for('frontend.ranking') }}";
    }

</script>
</body>
</html>
